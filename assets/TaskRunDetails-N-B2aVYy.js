import{j as e}from"./jsx-runtime-QvtbNqby.js";import{R as x,r as z}from"./index-BjzEU6Zr.js";import{P as t}from"./index-kGlasm3i.js";import{u as W}from"./index-BYMUMZMs.js";import{j as B,t as Y}from"./index-CfoIBI3E.js";import{P as G,u as J}from"./usePrefix-BezXHAvh.js";import{d as Q}from"./index-9NatbUAG.js";import{g as w,a as U,A as X,h as Z,_ as O}from"./floating-ui.react-zcwMlDfJ.js";import{c as q}from"./index-CjLpwf8N.js";import{d as ee}from"./deprecate-X_RArzr0.js";import{L as se}from"./index-CNcVnUbU.js";import{c as te}from"./events-OVwOsPzJ.js";import{n as E}from"./noopFn-g4z370MD.js";import{g as ne}from"./index-DZApqWLJ.js";import{b as M,d as P,T as ae,a as re,c as oe}from"./Tabs-gghMQKfC.js";import{T as ie}from"./Tooltip-CPLX6X0E.js";import{V as S}from"./ViewYAML-CKT6AdML.js";import{T as L}from"./Table-BuHWprYL.js";import{D as le}from"./DetailsHeader-DxveQ-6v.js";import{c as ce}from"./bucket-9-DuBbq6Ld.js";let V=class extends x.Component{constructor(){super(...arguments),w(this,"_switchRefs",[]),w(this,"state",{selectedIndex:void 0}),w(this,"handleItemRef",s=>a=>{this._switchRefs[s]=a}),w(this,"handleChildChange",s=>{const{selectionMode:a="automatic"}=this.props,{selectedIndex:n}=this.state,{index:r}=s,{key:o}=s;if(U(s,[X,Z])){const d=ne(o,r,this.props.children?.length),i=x.Children.toArray(this.props.children);if(a==="manual"){const m=this._switchRefs[d];m&&m.focus()}else this.setState({selectedIndex:d},()=>{if(typeof this.state.selectedIndex!="number")return;const m=i[this.state.selectedIndex],g=this._switchRefs[this.state.selectedIndex];g&&g.focus(),this.props.onChange({...s,index:this.state.selectedIndex,name:m.props.name,text:m.props.text})})}else n!==r&&this.setState({selectedIndex:r},()=>{const d=this._switchRefs[r];d&&d.focus(),this.props.onChange(s)})})}static getDerivedStateFromProps(s,a){let{selectedIndex:n=0}=s;const{prevSelectedIndex:r}=a;return r===n?null:{selectedIndex:n,prevSelectedIndex:n}}render(){const s=this.context,{children:a,className:n,light:r,selectedIndex:o=0,selectionMode:d="automatic",size:i,onChange:m=E,...g}=this.props,b=x.Children?.map(a,h=>h.type.displayName==="IconSwitch")?.every(h=>h===!0),p=q(`${s}--content-switcher`,n,{[`${s}--content-switcher--light`]:r,[`${s}--content-switcher--${i}`]:i,[`${s}--layout--size-${i}`]:i,[`${s}--content-switcher--icon-only`]:b});return x.createElement(se,O({size:{default:"md",min:"sm",max:"lg"}},g,{className:p,role:"tablist",onChange:void 0}),a&&x.Children.toArray(a).map((h,u)=>x.cloneElement(h,{index:u,onClick:te([this.handleChildChange,h.props.onClick]),onKeyDown:this.handleChildChange,selected:u===this.state.selectedIndex,ref:this.handleItemRef(u),size:i})))}};w(V,"propTypes",{children:t.node,className:t.string,light:ee(t.bool),onChange:t.func.isRequired,selectedIndex:t.number,selectionMode:t.oneOf(["automatic","manual"]),size:t.oneOf(["sm","md","lg"])});w(V,"contextType",G);const de=Q(V),D=x.forwardRef(function(s,a){const{children:n,className:r,disabled:o,index:d,name:i,onClick:m=E,onKeyDown:g=E,selected:b=!1,text:p,...h}=s,u=J(),v=j=>{j.preventDefault(),m?.({index:d,name:i,text:p})},T=j=>{const I=j.key||j.which;g?.({index:d,name:i,text:p,key:I})},N=q(r,`${u}--content-switcher-btn`,{[`${u}--content-switcher--selected`]:b}),C={onClick:v,onKeyDown:T,className:N,disabled:o};return x.createElement("button",O({type:"button",ref:a,role:"tab",tabIndex:b?0:-1,"aria-selected":b},h,C),x.createElement("span",{className:`${u}--content-switcher__label`,title:p},p!==void 0?p:n))});D.displayName="Switch";D.propTypes={children:t.node,className:t.string,disabled:t.bool,index:t.number,name:t.oneOfType([t.string,t.number]),onClick:t.func,onKeyDown:t.func,selected:t.bool,text:t.string};function $({children:c}){return c?e.jsx(S,{className:"tkn--param",resource:c}):null}$.__docgenInfo={description:"",methods:[],displayName:"Param"};function F({title:c}){return c?e.jsx(ie,{align:"top-end",autoAlign:!0,label:c,children:e.jsx("button",{className:"tkn--tooltip-trigger",type:"button",children:e.jsx(ce,{})})}):null}function K(c){return c?c.reduce((s,{name:a,description:n})=>(s[a]=n,s),{}):{}}const _={onViewChange:()=>{},task:{},taskRun:{}},A=({onViewChange:c=_.onViewChange,pod:s,task:a=_.task,taskRun:n=_.taskRun,view:r})=>{const o=W(),d=n.metadata.name,i=a?.spec||n.spec.taskSpec,m=K(i?.params),g=K(i?.results),[b,p]=z.useState(),h=s?.events?.length>0,u=typeof s?.resource=="string"?s.resource:{...s?.resource};u?.metadata?.managedFields&&delete u.metadata.managedFields;let v;h&&(v=s.events.map(l=>{const y={...l};return delete y.metadata?.managedFields,y})),z.useEffect(()=>{p("resource")},[d,r]);const T=[{key:"name",header:o.formatMessage({id:"dashboard.taskRunParams.name",defaultMessage:"Name"})},{key:"value",header:o.formatMessage({id:"dashboard.taskRunParams.value",defaultMessage:"Value"})},{key:"actions",header:""}],N=B(n.spec),C=N?.length?e.jsx(L,{size:"sm",headers:T,rows:N.map(({name:l,value:y})=>({id:l,name:l,actions:e.jsx(F,{title:m[l]}),value:e.jsx("span",{title:y,children:e.jsx($,{children:y})})}))}):null,j=n.status?.taskResults||n.status?.results,I=j?.length?e.jsx(L,{size:"sm",headers:T,rows:j.map(({name:l,value:y})=>({id:l,name:l,actions:e.jsx(F,{title:g[l]}),value:e.jsx("span",{title:y,children:e.jsx($,{children:y})})}))}):null,H=[C&&"params",I&&"results","status",s&&"pod"].filter(Boolean);let k=H.indexOf(r);k===-1&&(k=0);const R=[],f=[];return C&&(R.push(e.jsx(M,{children:o.formatMessage({id:"dashboard.taskRun.params",defaultMessage:"Parameters"})})),f.push(e.jsx(P,{children:k===f.length&&e.jsx("div",{className:"tkn--step-status",children:C})}))),I&&(R.push(e.jsx(M,{children:o.formatMessage({id:"dashboard.taskRun.results",defaultMessage:"Results"})})),f.push(e.jsx(P,{children:k===f.length&&e.jsx("div",{className:"tkn--step-status",children:I})}))),R.push(e.jsx(M,{children:o.formatMessage({id:"dashboard.taskRun.status",defaultMessage:"Status"})})),f.push(e.jsx(P,{children:k===f.length&&e.jsx("div",{className:"tkn--step-status",children:e.jsx(S,{dark:!0,enableSyntaxHighlighting:!0,resource:n.status||o.formatMessage({id:"dashboard.taskRun.status.pending",defaultMessage:"Pending"})})})})),s&&(R.push(e.jsx(M,{children:"Pod"})),f.push(e.jsx(P,{children:k===f.length&&e.jsxs("div",{className:"tkn--step-status",children:[h?e.jsxs(de,{onChange:({name:l})=>p(l),children:[e.jsx(D,{name:"resource",text:o.formatMessage({id:"dashboard.pod.resource",defaultMessage:"Resource"})}),e.jsx(D,{name:"events",text:o.formatMessage({id:"dashboard.pod.events",defaultMessage:"Events"})})]}):null,b==="resource"?e.jsx(S,{dark:!0,enableSyntaxHighlighting:!0,resource:u}):null,h&&b==="events"?e.jsx(S,{dark:!0,enableSyntaxHighlighting:!0,resource:v}):null]})}))),e.jsxs("div",{className:"tkn--step-details",children:[e.jsx(le,{displayName:d,hasWarning:Y(n),taskRun:n,type:"taskRun"}),e.jsxs(ae,{"aria-label":"TaskRun details",onChange:l=>c(H[l.selectedIndex]),selectedIndex:k,children:[e.jsx(re,{activation:"manual",children:R}),e.jsx(oe,{children:f})]})]})};A.propTypes={onViewChange:t.func,task:t.shape({}),taskRun:t.shape({})};const De=A;A.__docgenInfo={description:"",methods:[],displayName:"TaskRunDetails",props:{onViewChange:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},task:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{}},required:!1},taskRun:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{}},required:!1}}};export{De as T};
