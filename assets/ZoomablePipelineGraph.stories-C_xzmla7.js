import{j as r}from"./jsx-runtime-QvtbNqby.js";import{a as f}from"./chunk-454WOBUV-DFclqPoQ.js";import{R as m,r as E}from"./index-BjzEU6Zr.js";import{i as _}from"./index-BYMUMZMs.js";import"./usePrefix-BezXHAvh.js";import{B as c}from"./Button-DxuibFbN.js";import{P as R,p as O,a as D,t as V,b as A}from"./tasks-DJR0a4ia.js";import{I as w}from"./Icon-DeY_WDsw.js";import{Z as $,c as B}from"./bucket-18-CNixtB1a.js";import"./v4-D8aEg3BZ.js";import"./floating-ui.react-zcwMlDfJ.js";import"./index-B0z81K34.js";import"./index-kGlasm3i.js";import"./index-ED9P7qmL.js";import"./index-CjLpwf8N.js";import"./Tooltip-CPLX6X0E.js";import"./events-OVwOsPzJ.js";import"./index-CfoIBI3E.js";import"./Graph-BVFBbEoS.js";import"./path-CtoySGHN.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./bucket-17-ByI71b45.js";import"./bucket-3-DTnTkg5v.js";import"./bucket-2-DqY0dT-j.js";var x;const N=m.forwardRef(function(e,n){let{children:o,size:i=16,...s}=e;return m.createElement(w,{width:i,height:i,ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",...s},x||(x=m.createElement("path",{d:"M23,28a1,1,0,0,1-.71-.29l-6.13-6.14-3.33,5a1,1,0,0,1-1,.44,1,1,0,0,1-.81-.7l-6-20A1,1,0,0,1,6.29,5l20,6a1,1,0,0,1,.7.81,1,1,0,0,1-.44,1l-5,3.33,6.14,6.13a1,1,0,0,1,0,1.42l-4,4A1,1,0,0,1,23,28Zm0-2.41L25.59,23l-7.16-7.15,5.25-3.5L7.49,7.49l4.86,16.19,3.5-5.25Z"})),o)});var y;const L=m.forwardRef(function(e,n){let{children:o,size:i=16,...s}=e;return m.createElement(w,{width:i,height:i,ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",...s},y||(y=m.createElement("path",{d:"M25 11L23.59 12.41 26.17 15 17 15 17 5.83 19.59 8.41 21 7 16 2 11 7 12.41 8.41 15 5.83 15 15 5.83 15 8.41 12.41 7 11 2 16 7 21 8.41 19.59 5.83 17 15 17 15 26.17 12.41 23.59 11 25 16 30 21 25 19.59 23.59 17 26.17 17 17 26.17 17 23.59 19.59 25 21 30 16 25 11z"})),o)});var k=function(){function t(n){var o=n.x,i=o===void 0?0:o,s=n.y,a=s===void 0?0:s;this.x=0,this.y=0,this.x=i,this.y=a}var e=t.prototype;return e.value=function(){return{x:this.x,y:this.y}},e.toArray=function(){return[this.x,this.y]},t}();function X(t){return!!t&&t instanceof Element}function Y(t){return!!t&&(t instanceof SVGElement||"ownerSVGElement"in t)}function F(t){return!!t&&"createSVGPoint"in t}function U(t){return!!t&&"getScreenCTM"in t}function W(t){return!!t&&"changedTouches"in t}function q(t){return!!t&&"clientX"in t}function H(t){return!!t&&(t instanceof Event||"nativeEvent"in t&&t.nativeEvent instanceof Event)}function p(){return p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},p.apply(this,arguments)}var h={x:0,y:0};function J(t){if(!t)return p({},h);if(W(t))return t.changedTouches.length>0?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:p({},h);if(q(t))return{x:t.clientX,y:t.clientY};var e=t?.target,n=e&&"getBoundingClientRect"in e?e.getBoundingClientRect():null;return n?{x:n.x+n.width/2,y:n.y+n.height/2}:p({},h)}function v(t,e){if(!t||!e)return null;var n=J(e),o=Y(t)?t.ownerSVGElement:t,i=U(o)?o.getScreenCTM():null;if(F(o)&&i){var s=o.createSVGPoint();return s.x=n.x,s.y=n.y,s=s.matrixTransform(i.inverse()),new k({x:s.x,y:s.y})}var a=t.getBoundingClientRect();return new k({x:n.x-a.left-t.clientLeft,y:n.y-a.top-t.clientTop})}function b(t,e){if(X(t)&&e)return v(t,e);if(H(t)){var n=t,o=n.target;if(o)return v(o,n)}return null}const P={dragging:!1,scale:1,translate:{x:0,y:0}};class M extends E.Component{state=P;reset=()=>{this.setState(P)};center=()=>{this.setState({translate:{x:0,y:0}})};zoomIn=()=>{const{scale:e}=this.state;this.setZoom(e*1.25)};zoomOut=()=>{const{scale:e}=this.state;this.setZoom(e*.8)};zoomScroll=e=>{e.preventDefault(),e.deltaY>0?this.zoomIn():this.zoomOut()};setZoom=e=>{const{maxZoom:n,minZoom:o}=this.props,i=Math.min(Math.max(o,e),n);this.setState({scale:i})};dragStart=e=>{this.setState({dragging:!0}),this.startPoint=b(this.props.svg(),e),this.startTranslate=this.state.translate};dragEnd=()=>{this.setState({dragging:!1})};dragMove=e=>{if(!this.state.dragging)return;const n=b(this.props.svg(),e),o=n.x-this.startPoint.x,i=n.y-this.startPoint.y;this.setState(s=>({translate:{x:this.startTranslate.x+o/s.scale,y:this.startTranslate.y+i/s.scale}}))};render(){const{width:e,height:n,children:o}=this.props,{translate:i,scale:s}=this.state,a={x:e/2,y:n/2},d={x:i.x*s+a.x-a.x*s,y:i.y*s+a.y-a.y*s};return o({scale:s,translate:d,dragStart:this.dragStart,dragMove:this.dragMove,dragEnd:this.dragEnd,zoomIn:this.zoomIn,zoomOut:this.zoomOut,zoomScroll:this.zoomScroll,setZoom:this.setZoom,reset:this.reset,center:this.center})}}M.__docgenInfo={description:"",methods:[{name:"reset",docblock:null,modifiers:[],params:[],returns:null},{name:"center",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomIn",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomOut",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomScroll",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"setZoom",docblock:null,modifiers:[],params:[{name:"scale",optional:!1,type:null}],returns:null},{name:"dragStart",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"dragEnd",docblock:null,modifiers:[],params:[],returns:null},{name:"dragMove",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null}],displayName:"PanZoom"};const K=300,Q=600,S=.1,C=10;class Z extends E.Component{state={isPanningEnabled:!1};togglePanning=()=>{const{isPanningEnabled:e}=this.state;this.setState({isPanningEnabled:!e})};render(){const{intl:e}=this.props,{isPanningEnabled:n}=this.state;return r.jsx(M,{svg:()=>this.svg,minZoom:S,maxZoom:C,width:K,height:Q,children:({translate:o,scale:i,dragStart:s,dragMove:a,dragEnd:d,zoomIn:g,zoomOut:j,zoomScroll:z,setZoom:T,center:I,reset:G})=>r.jsxs("div",{className:"pipeline-graph-zoom-container",children:[r.jsx("svg",{width:"100%",height:"100%",ref:l=>{this.svg=l},onWheel:z,...n?{onMouseDown:s,onMouseUp:d,onMouseMove:a}:null,onDoubleClick:g,children:r.jsx("g",{draggable:!0,transform:`translate(${o.x},${o.y}) scale(${i},${i})`,children:r.jsx(R,{...this.props})})}),r.jsxs("div",{className:"toolbar",children:[r.jsx(c,{disabled:!n,iconDescription:e.formatMessage({id:"dashboard.graph.select",defaultMessage:"Select"}),kind:"ghost",onClick:this.togglePanning,renderIcon:l=>r.jsx(N,{size:20,...l})}),r.jsx(c,{disabled:n,iconDescription:e.formatMessage({id:"dashboard.graph.pan",defaultMessage:"Pan"}),kind:"ghost",onClick:this.togglePanning,renderIcon:l=>r.jsx(L,{size:20,...l})}),r.jsx(c,{kind:"ghost",onClick:G,children:"Reset"}),r.jsx(c,{kind:"ghost",onClick:I,children:"Center"}),r.jsx(c,{disabled:!1,hasIconOnly:!0,iconDescription:e.formatMessage({id:"dashboard.graph.zoomOut",defaultMessage:"Zoom out"}),kind:"ghost",onClick:j,renderIcon:l=>r.jsx($,{size:20,...l}),tooltipPosition:"top",tooltipAlignment:"end"}),r.jsx("input",{type:"range",min:S,max:C,value:i,step:".1",onChange:l=>T(l.target.value)}),r.jsx(c,{disabled:!1,hasIconOnly:!0,iconDescription:e.formatMessage({id:"dashboard.graph.zoomIn",defaultMessage:"Zoom in"}),kind:"ghost",onClick:g,renderIcon:l=>r.jsx(B,{size:20,...l}),tooltipPosition:"top",tooltipAlignment:"end"})]})]})})}}const tt=_(Z);Z.__docgenInfo={description:"",methods:[{name:"togglePanning",docblock:null,modifiers:[],params:[],returns:null}],displayName:"ZoomablePipelineGraph"};const Et={title:"legacy/ZoomablePipelineGraph"},u=()=>r.jsx(tt,{onClickStep:f("onClickStep"),onClickTask:f("onClickTask"),pipeline:O,pipelineRun:D,taskRuns:V,tasks:A});u.__docgenInfo={description:"",methods:[],displayName:"Default"};u.parameters={...u.parameters,docs:{...u.parameters?.docs,source:{originalSource:"() => <ZoomablePipelineGraph onClickStep={action('onClickStep')} onClickTask={action('onClickTask')} pipeline={pipeline} pipelineRun={pipelineRun} taskRuns={taskRuns} tasks={tasks} />",...u.parameters?.docs?.source}}};const wt=["Default"];export{u as Default,wt as __namedExportsOrder,Et as default};
