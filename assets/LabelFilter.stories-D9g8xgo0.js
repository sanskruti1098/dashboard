import{a as u}from"./chunk-454WOBUV-DFclqPoQ.js";import{j as t}from"./jsx-runtime-QvtbNqby.js";import{R as b,r as x}from"./index-BjzEU6Zr.js";import{i as M}from"./index-BYMUMZMs.js";import{u as C}from"./usePrefix-BezXHAvh.js";import{B as h}from"./Button-DxuibFbN.js";import{_ as V}from"./floating-ui.react-zcwMlDfJ.js";import{P as f}from"./index-kGlasm3i.js";import{c as k}from"./index-CjLpwf8N.js";import{L as y}from"./Link-DRIuGUpd.js";import{S as A}from"./Search-DGNYnC60.js";import{T as v}from"./Tag-YsAF4sgM.js";import{A as j}from"./Notification-DTvxI4If.js";import{F as N}from"./index-DZApqWLJ.js";import"./v4-D8aEg3BZ.js";import"./index-ED9P7qmL.js";import"./Tooltip-CPLX6X0E.js";import"./events-OVwOsPzJ.js";import"./index-B0z81K34.js";import"./deprecate-X_RArzr0.js";import"./FormContext-IWjAIOZU.js";import"./bucket-3-DTnTkg5v.js";import"./Icon-DeY_WDsw.js";import"./noopFn-g4z370MD.js";import"./bucket-6-CpbjS_H5.js";import"./bucket-2-DqY0dT-j.js";import"./bucket-18-CNixtB1a.js";import"./bucket-9-DuBbq6Ld.js";function F(r){let{className:l,children:e,...i}=r;const n=C(),a=k(`${n}--form`,l);return b.createElement("form",V({className:a},i),e)}F.propTypes={children:f.node,className:f.string};function g(r){return t.jsx(N,{flags:{"enable-experimental-focus-wrap-without-sentinels":!0},children:t.jsx(j,{...r})})}g.__docgenInfo={description:"",methods:[],displayName:"ActionableNotification"};function S(r){return r.filter((l,e)=>r.indexOf(l)>=e)}class c extends x.Component{state={currentFilterValue:"",isValid:!0,filterMessage:null,url:"",urlMessage:""};handleAddFilter=l=>{l.preventDefault();const{intl:e}=this.props,{currentFilterValue:i}=this.state,n="([a-z0-9A-Z-_./]:[a-z0-9A-Z-_.],?)+",a=i.replace(/\s/g,"");if(!a.match(n)){this.setState({isValid:!1,filterMessage:e.formatMessage({id:"dashboard.labelFilter.invalid",defaultMessage:"Filters must be of the format labelKey:labelValue and contain accepted label characters"}),url:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set",urlMessage:e.formatMessage({id:"dashboard.labelFilter.syntaxMessage",defaultMessage:"See the Kubernetes Label documentation for valid syntax"})});return}if(a.split(":")[1].length>63){this.setState({isValid:!1,filterMessage:e.formatMessage({id:"dashboard.labelFilter.invalidLength",defaultMessage:"Filters must be of the format labelKey:labelValue and contain less than 64 characters"})});return}let s=a.replace(/:/g,"=").split(",");if(s=S(s),this.props.filters.includes(s[0])){this.setState({isValid:!1,filterMessage:e.formatMessage({id:"dashboard.labelFilter.duplicate",defaultMessage:"No duplicate filters allowed"}),url:"",urlMessage:""});return}this.props.handleAddFilter(this.props.filters.concat(s)),this.resetCurrentFilterValue()};handleChange=l=>{const e=l.target.value;this.setState({currentFilterValue:e})};handleCloseFilterError=()=>{this.setState({isValid:!0,filterMessage:null,url:"",urlMessage:""})};resetCurrentFilterValue(){this.setState({isValid:!0,filterMessage:null,url:"",urlMessage:"",currentFilterValue:""})}render(){const{filters:l,intl:e}=this.props,{currentFilterValue:i,filterMessage:n,isValid:a,url:p,urlMessage:m}=this.state,s=e.formatMessage({id:"dashboard.labelFilter.searchPlaceholder",defaultMessage:"Input a label filter of the format labelKey:labelValue"});return t.jsxs("div",{className:"tkn--label-filter",children:[!a&&t.jsx(g,{inline:!0,kind:"error",lowContrast:!0,title:n,onCloseButtonClick:this.handleCloseFilterError,children:t.jsx(y,{href:p,children:m})}),t.jsxs(F,{onSubmit:this.handleAddFilter,autoComplete:"on",children:[t.jsx(A,{placeholder:s,labelText:s,onChange:this.handleChange,value:i,name:"filter-search",size:"lg"}),t.jsx(h,{type:"submit",className:"tkn--visually-hidden",children:e.formatMessage({id:"dashboard.labelFilter.addFilterButton",defaultMessage:"Add filter"})})]}),t.jsxs("div",{className:"tkn--filters",children:[l.map(o=>t.jsx(v,{filter:!0,onClick:()=>this.props.handleDeleteFilter(o),onClose:()=>this.props.handleDeleteFilter(o),type:"high-contrast",children:o.replace(/=/g,":")},o)),l.length>0&&t.jsx(h,{kind:"ghost",size:"sm",onClick:this.props.handleClearFilters,children:e.formatMessage({id:"dashboard.labelFilter.clearAll",defaultMessage:"Clear all"})})]})]})}}c.defaultProps={filters:[]};const _=M(c);c.__docgenInfo={description:"",methods:[{name:"handleAddFilter",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"handleChange",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"handleCloseFilterError",docblock:null,modifiers:[],params:[],returns:null},{name:"resetCurrentFilterValue",docblock:null,modifiers:[],params:[],returns:null}],displayName:"LabelFilter",props:{filters:{defaultValue:{value:"[]",computed:!1},required:!1}}};const se={component:_,title:"LabelFilter"},d={args:{filters:["tekton.dev/pipeline=output-pipeline"],handleAddFilter:u("handleAddFilter"),handleClearFilters:u("handleClearFilters"),handleDeleteFilter:u("handleDeleteFilter")}};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:`{
  args: {
    filters: ['tekton.dev/pipeline=output-pipeline'],
    handleAddFilter: action('handleAddFilter'),
    handleClearFilters: action('handleClearFilters'),
    handleDeleteFilter: action('handleDeleteFilter')
  }
}`,...d.parameters?.docs?.source}}};const ie=["Default"];export{d as Default,ie as __namedExportsOrder,se as default};
