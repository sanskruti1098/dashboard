import{j as C}from"./jsx-runtime-QvtbNqby.js";import{r as s,R as l}from"./index-BjzEU6Zr.js";import{i as re}from"./index-BYMUMZMs.js";import{u as S}from"./usePrefix-BezXHAvh.js";import{B as W}from"./Button-DxuibFbN.js";import{_ as D,m as L,A as le,d as ie,S as ce,u as ue,b as de,c as me,f as fe}from"./floating-ui.react-zcwMlDfJ.js";import{c as N}from"./index-CjLpwf8N.js";import{P as e}from"./index-kGlasm3i.js";import{u as X}from"./useControllableState-Co_owzu1.js";import{b as pe,u as he}from"./Tooltip-CPLX6X0E.js";import{M as G,u as ge,b as Y,c as be,O as xe,a as ye}from"./index-9NatbUAG.js";import{T as Ce}from"./deprecate-X_RArzr0.js";import{e as ke,f as Ie,d as Z,c as Me}from"./bucket-2-DqY0dT-j.js";import{m as Ee}from"./mergeRefs-CTUecegF.js";import{M as Re}from"./Modal-_W9C5eOo.js";var J,Q;const Ne=150,we=300,q=s.forwardRef(function(t,o){let{children:g,className:c,disabled:h,kind:m="default",label:f,onClick:a,renderIcon:i,shortcut:p,...u}=t;const n=S(),r=s.useContext(G),d=s.useRef(null),E=pe([o,d]),[k,b]=s.useState({x:-1,y:-1}),[R,v]=s.useState(!1),y=!!g,[I,A]=s.useState(!1),_=s.useRef(null),T=s.useRef(null),B=h&&!y,z=m==="danger"&&!y;function P(){r.dispatch({type:"registerItem",payload:{ref:d,disabled:!!h}})}function $(){if(!d.current)return;const{x,y:O,width:H,height:U}=d.current.getBoundingClientRect();b(R?{x:[-x,x-H],y:[O,O+U]}:{x:[x,x+H],y:[O,O+U]}),A(!0)}function w(){A(!1),b({x:-1,y:-1})}function j(x){B||(y?$():(r.state.requestCloseRoot(x),a&&a(x)))}function F(){T.current&&(clearTimeout(T.current),T.current=null),_.current=setTimeout(()=>{$()},Ne)}function se(){_.current&&(clearTimeout(_.current),T.current=setTimeout(()=>{w(),d.current?.focus()},we))}function oe(x){y&&L(x,le)&&($(),x.stopPropagation()),(L(x,ie)||L(x,ce))&&j(x),u.onKeyDown&&u.onKeyDown(x)}const ae=N(c,`${n}--menu-item`,{[`${n}--menu-item--disabled`]:B,[`${n}--menu-item--danger`]:z});s.useEffect(()=>{P()},[]);const{direction:V}=ge();s.useEffect(()=>{document?.dir==="rtl"||V==="rtl"?v(!0):v(!1)},[V]);const K=r.state.mode==="basic"||u.role==="menuitemcheckbox"||u.role==="menuitemradio";return s.useEffect(()=>{K&&i&&!r.state.hasIcons&&r.dispatch({type:"enableIcons"})},[K,i,r.state.hasIcons,r]),l.createElement("li",D({role:"menuitem"},u,{ref:E,className:ae,tabIndex:-1,"aria-disabled":B??void 0,"aria-haspopup":y??void 0,"aria-expanded":y?I:void 0,onClick:j,onMouseEnter:y?F:void 0,onMouseLeave:y?se:void 0,onKeyDown:oe}),l.createElement("div",{className:`${n}--menu-item__icon`},K&&i&&l.createElement(i,null)),l.createElement(Ce,{as:"div",className:`${n}--menu-item__label`,title:f},f),p&&!y&&l.createElement("div",{className:`${n}--menu-item__shortcut`},p),y&&l.createElement(l.Fragment,null,l.createElement("div",{className:`${n}--menu-item__shortcut`},R?J||(J=l.createElement(ke,null)):Q||(Q=l.createElement(Ie,null))),l.createElement(Y,{label:f,open:I,onClose:()=>{w(),d.current?.focus()},x:k.x,y:k.y},g)))});q.propTypes={children:e.node,className:e.string,disabled:e.bool,kind:e.oneOf(["default","danger"]),label:e.string.isRequired,onClick:e.func,renderIcon:e.oneOfType([e.func,e.object]),shortcut:e.string};const ve=s.forwardRef(function(t,o){let{className:g,defaultSelected:c,label:h,onChange:m,selected:f,...a}=t;const i=S(),p=s.useContext(G);p.state.mode;const[u,n]=X({value:f,onChange:m,defaultValue:c??!1});function r(E){n(!u),m&&m(E)}s.useEffect(()=>{p.state.hasIcons||p.dispatch({type:"enableIcons"})},[p.state.hasIcons,p]);const d=N(g,`${i}--menu-item-selectable--selected`);return l.createElement(q,D({},a,{ref:o,label:h,className:d,role:"menuitemcheckbox","aria-checked":u,renderIcon:u?Z:void 0,onClick:r}))});ve.propTypes={className:e.string,defaultSelected:e.bool,label:e.string.isRequired,onChange:e.func,selected:e.bool};const Te=s.forwardRef(function(t,o){let{children:g,className:c,label:h,...m}=t;const f=S(),a=N(c,`${f}--menu-item-group`);return l.createElement("li",{className:a,role:"none",ref:o},l.createElement("ul",D({},m,{role:"group","aria-label":h}),g))});Te.propTypes={children:e.node,className:e.string,label:e.string.isRequired};const Se=M=>M.toString(),De=s.forwardRef(function(t,o){let{className:g,defaultSelectedItem:c,items:h,itemToString:m=Se,label:f,onChange:a,selectedItem:i,...p}=t;const u=S(),n=s.useContext(G);n.state.mode;const[r,d]=X({value:i,onChange:a,defaultValue:c});function E(b,R){d(b),a&&a(R)}s.useEffect(()=>{n.state.hasIcons||n.dispatch({type:"enableIcons"})},[n.state.hasIcons,n]);const k=N(g,`${u}--menu-item-radio-group`);return l.createElement("li",{className:k,role:"none",ref:o},l.createElement("ul",D({},p,{role:"group","aria-label":f}),h.map((b,R)=>l.createElement(q,{key:R,label:m(b),role:"menuitemradio","aria-checked":b===r,renderIcon:b===r?Z:void 0,onClick:v=>{E(b,v)}}))))});De.propTypes={className:e.string,defaultSelectedItem:e.any,itemToString:e.func,items:e.array,label:e.string.isRequired,onChange:e.func,selectedItem:e.any};const ee=s.forwardRef(function(t,o){let{className:g,...c}=t;const h=S(),m=N(g,`${h}--menu-item-divider`);return l.createElement("li",D({},c,{className:m,role:"separator",ref:o}))});ee.propTypes={className:e.string};const _e=["primary","tertiary","ghost"],Be="primary",te=s.forwardRef(function(t,o){let{children:g,className:c,disabled:h,kind:m=Be,label:f,size:a="lg",menuAlignment:i="bottom",tabIndex:p=0,...u}=t;const n=he("MenuButton"),r=S(),d=s.useRef(null),E=[fe({crossAxis:!1})];(i==="bottom"||i==="top")&&E.push(de({apply(w){let{rects:j,elements:F}=w;Object.assign(F.floating.style,{width:`${j.reference.width}px`})}}));const{refs:k,floatingStyles:b,placement:R,middlewareData:v}=ue({placement:i,strategy:"fixed",middleware:E,whileElementsMounted:me}),y=Ee(o,d),{open:I,handleClick:A,handleMousedown:_,handleClose:T}=be(d);s.useLayoutEffect(()=>{Object.keys(b).forEach(w=>{k.floating.current&&(k.floating.current.style[w]=b[w])})},[b,k.floating,v,R,I]);function B(){d.current&&A()}const z=N(`${r}--menu-button__container`,c),P=N(`${r}--menu-button__trigger`,{[`${r}--menu-button__trigger--open`]:I}),$=N(`${r}--menu-button__${i}`);return l.createElement("div",D({},u,{ref:y,"aria-owns":I?n:void 0,className:z}),l.createElement(W,{ref:k.setReference,className:P,size:a,tabIndex:p,kind:m,renderIcon:Me,disabled:h,"aria-haspopup":!0,"aria-expanded":I,onClick:B,onMouseDown:_,"aria-controls":I?n:void 0},f),l.createElement(Y,{containerRef:d,menuAlignment:i,className:$,ref:k.setFloating,id:n,legacyAutoalign:!1,label:f,mode:"basic",size:a,open:I,onClose:T},g))});te.propTypes={children:e.node.isRequired,className:e.string,disabled:e.bool,kind:e.oneOf(_e),label:e.string.isRequired,menuAlignment:e.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end"]),size:e.oneOf(["sm","md","lg"]),tabIndex:e.number};class ne extends s.Component{state={showDialog:!1};handleModalAction=()=>{const{action:t}=this.state;t(),this.handleClose()};handleClose=()=>{this.setState({showDialog:!1})};handleClick=(t,o)=>{o?this.setState({action:t,modal:o,showDialog:!0}):t()};getButton(){const{intl:t,items:o,kind:g,resource:c}=this.props,h=g==="button";if(h&&o.length===1){const{action:f,actionText:a,icon:i,modalProperties:p}=o[0];return C.jsx(W,{kind:"tertiary",onClick:()=>this.handleClick(()=>f(c),p),renderIcon:i,size:"md",children:a})}const m=t.formatMessage({id:"dashboard.list.menu.tooltip",defaultMessage:"Actions"});return h?C.jsx(te,{className:"tkn--actions-dropdown",kind:"tertiary",label:m,menuAlignment:"bottom-end",size:"md",children:o.map(f=>{const{actionText:a,action:i,danger:p,disable:u,hasDivider:n,modalProperties:r}=f,d=u&&u(c);return C.jsxs(C.Fragment,{children:[n&&C.jsx(ee,{}),C.jsx(q,{disabled:d,kind:p?"danger":"default",label:a,onClick:()=>this.handleClick(()=>i(c),r)},a)]})})}):C.jsx(xe,{align:"left","aria-label":m,className:"tkn--actions-dropdown",flipped:!0,iconDescription:m,selectorPrimaryFocus:"button:not([disabled])",title:m,children:o.map(f=>{const{actionText:a,action:i,danger:p,disable:u,hasDivider:n,modalProperties:r}=f,d=u&&u(c);return C.jsx(ye,{disabled:d,hasDivider:n,isDelete:p,itemText:a,onClick:()=>this.handleClick(()=>i(c),r),requireTitle:!0},a)})})}render(){const{modal:t={},showDialog:o}=this.state,{intl:g,resource:c}=this.props,h=o?C.jsx(Re,{open:o,modalHeading:t.heading,primaryButtonText:t.primaryButtonText,secondaryButtonText:t.secondaryButtonText||g.formatMessage({id:"dashboard.modal.cancelButton",defaultMessage:"Cancel"}),onRequestClose:this.handleClose,onRequestSubmit:this.handleModalAction,onSecondarySubmit:this.handleClose,danger:t.danger,children:t.body&&t.body(c)}):null;return C.jsxs(C.Fragment,{children:[this.getButton(),h]})}}const Qe=re(ne);ne.__docgenInfo={description:"",methods:[{name:"handleModalAction",docblock:null,modifiers:[],params:[],returns:null},{name:"handleClose",docblock:null,modifiers:[],params:[],returns:null},{name:"handleClick",docblock:null,modifiers:[],params:[{name:"action",optional:!1,type:null},{name:"modalProperties",optional:!1,type:null}],returns:null},{name:"getButton",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Actions"};export{Qe as A};
