import{u as Ne,_ as g,s as je,b as Pe,f as Ce,c as Le}from"./floating-ui.react-zcwMlDfJ.js";import{R as o,r as u}from"./index-BjzEU6Zr.js";import{u as X,L as _,a as Re,b as Fe}from"./index-eKhO17z2.js";import{c as $}from"./index-CjLpwf8N.js";import{P as t}from"./index-kGlasm3i.js";import{m as Be}from"./mergeRefs-CTUecegF.js";import{d as J}from"./deprecate-X_RArzr0.js";import{u as Ke}from"./usePrefix-BezXHAvh.js";import{F as Me}from"./FormContext-IWjAIOZU.js";import{W as ke,a as ze}from"./bucket-18-CNixtB1a.js";import{d as We}from"./bucket-2-DqY0dT-j.js";const qe=je(),{ToggleButtonKeyDownArrowDown:Ue,ToggleButtonKeyDownArrowUp:He,ToggleButtonKeyDownHome:Ge,ToggleButtonKeyDownEnd:Ve,ItemMouseMove:Je,MenuMouseLeave:Qe}=X.stateChangeTypes,Q=l=>typeof l=="string"?l:typeof l=="number"?`${l}`:l!==null&&typeof l=="object"&&"label"in l&&typeof l.label=="string"?l.label:"",Y=o.forwardRef((l,Z)=>{let{autoAlign:a=!1,className:ee,disabled:w=!1,direction:N="bottom",items:j,label:P,["aria-label"]:te,ariaLabel:ne,itemToString:f=Q,itemToElement:C=null,renderSelectedItem:L,type:oe="default",size:I,onChange:R,id:le,titleText:F="",hideLabel:se,helperText:T="",translateWithId:re,light:B,invalid:r,invalidText:ie,warn:y,warnText:ae,initialSelectedItem:de,selectedItem:K,downshiftProps:ce,readOnly:E,slug:h,...pe}=l;const{refs:m,floatingStyles:S}=Ne(a?{placement:N,strategy:"fixed",middleware:[Pe({apply(e){let{rects:s,elements:i}=e;Object.assign(i.floating.style,{width:`${s.reference.width}px`})}}),Ce()],whileElementsMounted:Le}:{});u.useEffect(()=>{a&&Object.keys(S).forEach(e=>{m.floating.current&&(m.floating.current.style[e]=S[e])})},[S,a,m.floating]);const n=Ke(),{isFluid:D}=u.useContext(Me),M={...ce,items:j,itemToString:f,initialSelectedItem:de,onSelectedItemChange:Ee,stateReducer:fe,isItemDisabled(e,s){return e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0}},{current:ue}=u.useRef(qe());function fe(e,s){const{changes:i,props:p,type:O}=s,{highlightedIndex:V}=i;switch(O){case Ue:case He:case Ge:case Ve:if(V>-1){const Oe=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`);p.scrollIntoView(Oe[V])}return i;case Je:case Qe:return{...i,highlightedIndex:e.highlightedIndex}}return i}K!==void 0&&(M.selectedItem=K);const{isOpen:b,getToggleButtonProps:me,getLabelProps:be,getMenuProps:ge,getItemProps:we,selectedItem:d,highlightedIndex:ye}=X(M),c=oe==="inline",k=!r&&y,[he,xe]=u.useState(!1),_e=$(`${n}--dropdown`,{[`${n}--dropdown--invalid`]:r,[`${n}--dropdown--warning`]:k,[`${n}--dropdown--open`]:b,[`${n}--dropdown--inline`]:c,[`${n}--dropdown--disabled`]:w,[`${n}--dropdown--light`]:B,[`${n}--dropdown--readonly`]:E,[`${n}--dropdown--${I}`]:I,[`${n}--list-box--up`]:N==="top",[`${n}--dropdown--autoalign`]:a}),$e=$(`${n}--label`,{[`${n}--label--disabled`]:w,[`${n}--visually-hidden`]:se}),Ie=$(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:w}),Te=$(`${n}--dropdown__wrapper`,`${n}--list-box__wrapper`,ee,{[`${n}--dropdown__wrapper--inline`]:c,[`${n}--list-box__wrapper--inline`]:c,[`${n}--dropdown__wrapper--inline--invalid`]:c&&r,[`${n}--list-box__wrapper--inline--invalid`]:c&&r,[`${n}--list-box__wrapper--fluid--invalid`]:D&&r,[`${n}--list-box__wrapper--fluid--focus`]:D&&he&&!b,[`${n}--list-box__wrapper--slug`]:h}),z=T?`dropdown-helper-text-${ue}`:void 0,v=C,x=me(),W=T&&!D?o.createElement("div",{id:z,className:Ie},T):null;function Ee(e){let{selectedItem:s}=e;R&&R({selectedItem:s??null})}const q=e=>{xe(e.type==="focus")},A=Be(x.ref,Z),[U,Se]=u.useState();let[De,H]=u.useState(!1);const ve=E?{onClick:e=>{e.preventDefault(),A.current!==void 0&&A.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&H(!0),(De&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(U&&clearTimeout(U),Se(setTimeout(()=>{H(!1)},3e3))),x.onKeyDown&&x.onKeyDown(e)}},Ae=u.useMemo(()=>ge({ref:a?m.setFloating:null}),[a]);let G;return h&&h.type?.displayName==="Slug"&&(G=o.cloneElement(h,{size:"mini"})),o.createElement("div",g({className:Te},pe),F&&o.createElement("label",g({className:$e},be()),F),o.createElement(_,{onFocus:q,onBlur:q,"aria-label":ne||te,size:I,className:_e,invalid:r,invalidText:ie,warn:y,warnText:ae,light:B,isOpen:b,ref:a?m.setReference:null,id:le},r&&o.createElement(ke,{className:`${n}--list-box__invalid-icon`}),k&&o.createElement(ze,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),o.createElement("button",g({type:"button",className:`${n}--list-box__field`,disabled:w,"aria-disabled":E?!0:void 0,"aria-describedby":!c&&!r&&!y&&W?z:void 0,title:d&&f!==void 0?f(d):Q(P)},x,ve,{ref:A}),o.createElement("span",{className:`${n}--list-box__label`},d?L?L(d):f(d):P),o.createElement(_.MenuIcon,{isOpen:b,translateWithId:re})),G,o.createElement(_.Menu,Ae,b&&j.map((e,s)=>{const i=e!==null&&typeof e=="object",p=we({item:e,index:s});e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"id")&&(p.id=e.id);const O=i&&"text"in e&&C?e.text:f(e);return o.createElement(_.MenuItem,g({key:p.id,isActive:d===e,isHighlighted:ye===s,title:O,disabled:p["aria-disabled"]},p),typeof e=="object"&&v!==void 0&&v!==null?o.createElement(v,g({key:p.id},e)):f(e),d===e&&o.createElement(We,{className:`${n}--list-box__menu-item__selected-icon`}))}))),!c&&!r&&!y&&W)});Y.displayName="Dropdown";Y.propTypes={"aria-label":t.string,ariaLabel:J(t.string),autoAlign:t.bool,className:t.string,direction:t.oneOf(["top","bottom"]),disabled:t.bool,downshiftProps:t.object,helperText:t.node,hideLabel:t.bool,id:t.string.isRequired,initialSelectedItem:t.oneOfType([t.object,t.string,t.number]),invalid:t.bool,invalidText:t.node,itemToElement:t.func,itemToString:t.func,items:t.array.isRequired,label:t.node.isRequired,light:J(t.bool),onChange:t.func,readOnly:t.bool,renderSelectedItem:t.func,selectedItem:t.oneOfType([t.object,t.string,t.number]),size:Re,slug:t.node,titleText:t.node.isRequired,translateWithId:t.func,type:Fe,warn:t.bool,warnText:t.node};export{Y as D};
